<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->

    <head>
        <meta charset="utf-8">
        <title>Donor's Account Page - Ekthacares – A Drop of Hope, A Lifeline for Lives</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="description" content="Ekthacares – A Drop of Hope, A Lifeline for Lives">
        <meta name="author" content="xenioushk">
        <link rel="shortcut icon" href="images/favicon.png" />

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
          <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- The styles --> 
        <link rel="stylesheet" href="css/bootstrap.min.css" />
        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css" >
        <link href="css/animate.css" rel="stylesheet" type="text/css" >
        <link href="css/owl.carousel.css" rel="stylesheet" type="text/css" >
        <link href="css/venobox.css" rel="stylesheet" type="text/css" >
        <link rel="stylesheet" href="css/styles.css" />
        
        <style>
	.results {
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 10px;
            border: 1px solid #bdc3c7;
            text-align: left;
        }

        th {
            background-color: #ff0000;
            color: white;
        }

        td {
            background-color: white;
        }
        
    a {
    text-decoration: underline; /* Adds an underline */
    color: #5d0a0c;
    font-size: 15px;
    font-weight: bold;
    
}


		a:hover {
   			 color: #ff0000; /* Optional hover effect */
		}
		
		input[type="text"], input[type="number"], input[type="tel"], input[type="email"], input[type="date"], select, textarea {
    width: 20%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    box-sizing: border-box;
    font-size: 16px;
    float: right;
}

 #profileTooltip {
   		 position: absolute;
    	 display: none;
 	  	 background-color: #fff;  /* Background color for readability */
  		 border: 1px solid #ccc;
   	 	 padding: 5px;  /* Small padding */
   		 z-index: 1000;
   		 width: 250px;   /* Auto width to fit content */
  		  
		}
	</style>
    <body> 

        <div id="preloader">
            <span class="margin-bottom"><img src="images/loader.gif" alt="" /></span>
        </div>

        <!--  HEADER -->

        <header class="main-header clearfix" data-sticky_header="true">

            <div class="top-bar clearfix">

                <div class="container">

                    <div class="row">

                        <div class="col-md-8 col-sm-12">

                            <p>
                                <span><i class="fa fa-building-o"></i> <strong>Contact: </strong>  4th floor, ektha towers, kondapur</span>
                                <span>&nbsp;<i class="fa fa-phone"></i> <strong>Call Us:</strong> +91 99999 99999</span>
                            </p>

                        </div>

                        <div class="col-md-4col-sm-12">
                            <div class="top-bar-social">
                                <a href="#"><i class="fa fa-facebook rounded-box"></i></a>
                                <a href="#"><i class="fa fa-twitter rounded-box"></i></a>
                                <a href="#"><i class="fa fa-google-plus rounded-box"></i></a>
                                <a href="#"><i class="fa fa-instagram rounded-box"></i></a>
                                <a href="#"><i class="fa fa-youtube rounded-box"></i></a>
                            </div>   
                        </div> 

                    </div>

                </div> <!--  end .container -->

            </div> <!--  end .top-bar  -->

            <section class="header-wrapper navgiation-wrapper">

                <div class="navbar navbar-default">			
                    <div class="container">

                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a class="logo" href="index.html"><img alt="" src="images/logo1.png"></a>
                        </div>

                         <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
        <li>
            <a href="adminhome">Home</a>
        </li>
        <li>
            <a href="contact">Contact</a>
        </li>
        <li>
            <a href="logout1">Logout</a>
        </li>
    </ul>
</div> <!-- Closing the navbar-collapse div -->
                    </div>
                </div>

            </section>

        </header> 
        
        
         <div class="contact-form-block">
        <h2 class="contact-title"> All Search Requests
</h2>
    </div> 
			<div class="donortracking_container" style="padding:70px">
			
    
     <!--  Applying Filter  -->   
     <div class="filter-container">
        <select id="filterSelect" onchange="filterRequests()">
            <option value="">-- Select Filter --</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
            <option value="last3months">Last 3 Months</option>
        </select>
    </div>
    
    
   <!--  Row count of filter's data  -->
    <div id="resultCount" style="display: none;"></div>
    
     <!--  Row count of all search request data  -->
    <div class="results-count">
    <span>Total Results: </span>
    <span id="totalResultsCount" th:text="${#lists.size(searchRequests)}">0</span> <!-- Displaying the count of searchRequests -->
</div>
     <div class="results" > 
      <a th:href="@{/allsearchrequestdata/download}" class="download-btn">Download Data</a>               
            <table >
             <thead>
            <tr>
            	<th>ID</th>
                <th>User ID</th>
                <th>Blood Group</th>
                <th>City</th>
                <th>State</th>
                <th>TimeStamp</th>
            </tr>
        </thead>
            <tbody>
            <tr th:each="request : ${searchRequests}">
            	 <td th:text="${request.id}"></td>
                <td>
                    <a href="#" 
                       data-toggle="modal" data-target="#userProfileModal" 
                       th:attr="data-user-id=${request.userId}" 
                       class="view-profile1">
                       <span th:text="${request.userId}">User ID</span>
                    </a>
                </td>
                <td th:text="${request.bloodgroup}">Blood Group</td>
                <td th:text="${request.city}">City</td>
                <td th:text="${request.state}">State</td>
                <td th:text="${request.formattedTimestamp}">TimeStamp</td>
                
            </tr>
        </tbody>
  
            </table>
            
            <div id="profileTooltip" class="profile-tooltip"></div>
            
        <nav>
    <ul class="pagination" style="float:right">

        <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
            <a class="page-link" th:href="@{/allsearchrequestdata(page=${currentPage - 1}, filter=${filter})}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        <!-- Page Numbers: Loop through the total number of pages -->
        <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}" th:classappend="${i == currentPage} ? 'active'">
            <a class="page-link" th:href="@{/allsearchrequestdata(page=${i}, filter=${filter})}" th:text="${i + 1}">1</a>
        </li>

        <!-- Next Button: Disable if on the last page -->
        <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
            <a class="page-link" th:href="@{/allsearchrequestdata(page=${currentPage + 1}, filter=${filter})}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</nav>

                
           </div>
    
</div>


        <!-- START FOOTER  -->

        <footer>            

            <section class="footer-widget-area footer-widget-area-bg">

                <div class="container">

                    <div class="row">

                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="about-footer">

                                <div class="row">

                                    <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                                        <img src="images/logo-footer.png" alt="" />
                                    </div> <!--  end col-lg-3-->

                                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                                        <p>
                                            At Ekthacares, we believe in the power of community and the difference one person can make. Our mission is to connect generous donors with those in urgent need of blood. Whether you're here to donate, request blood, or simply learn more, your involvement can save lives.
                                        </p>
                                    </div> <!--  end .col-lg-9  -->

                                </div> <!--  end .row -->

                            </div> <!--  end .about-footer  -->

                        </div> <!--  end .col-md-12  -->

                    </div> <!--  end .row  -->

                    <div class="row"> 						                      

                        <div class="col-md-4 col-sm-6 col-xs-12">

                            <div class="footer-widget">

                                <div class="sidebar-widget-wrapper">

                                    <div class="footer-widget-header clearfix">
                                        <h3>Contact Us</h3>
                                    </div>  <!--  end .footer-widget-header --> 


                                    <div class="textwidget">                                       

                                        <i class="fa fa-envelope-o fa-contact"></i> <p><a href="#">support@ekthacares.com</a><br/><a href="#">helpme@ekthacares.com</a></p>

                                        <i class="fa fa-location-arrow fa-contact"></i> <p>4th floor, ektha towers,<br/> kondapur. Hyderabad-18, India</p>

                                        <i class="fa fa-phone fa-contact"></i> <p>Office:&nbsp; +91 99999 99999<br/>Cell:&nbsp; +91 99999 99999</p>                              

                                    </div>

                                </div> <!-- end .footer-widget-wrapper  -->

                            </div> <!--  end .footer-widget  -->

                        </div> <!--  end .col-md-4 col-sm-12 -->   

                        <div class="col-md-4 col-sm-12 col-xs-12">

                            <div class="footer-widget clearfix">

                                <div class="sidebar-widget-wrapper">

                                    <div class="footer-widget-header clearfix">
                                        <h3>Support Links</h3>
                                    </div>  <!--  end .footer-widget-header --> 


                                    <ul class="footer-useful-links">

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Thalassemia
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Cell Elofrosis
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Myelodysasia
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Blood Count
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Hemolytimia
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Ychromas Eosis 
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Hyrcoagulable
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Thrombo Xtosis
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Sicklenemiaxs
                                            </a>
                                        </li>

                                        <li>
                                            <a href="#">
                                                <i class="fa fa-caret-right fa-footer"></i>
                                                Aplastic Anemia
                                            </a>
                                        </li>                                       

                                    </ul>

                                </div> <!--  end .footer-widget  -->        

                            </div> <!--  end .footer-widget  -->            

                        </div> <!--  end .col-md-4 col-sm-12 -->    

                        <div class="col-md-4 col-sm-6 col-xs-12">

                            <div class="footer-widget">
                                <div class="sidebar-widget-wrapper">
                                    <div class="footer-widget-header clearfix">
                                        <h3>Subscribe Us</h3>
                                    </div>
                                    <p>Signup for regular newsletter and stay up to date with our latest news.</p>
                                    <div class="footer-subscription">
                                        <p>
                                            <input id="mc4wp_email" class="form-control" required="" placeholder="Enter Your Email" name="EMAIL" type="email">
                                        </p>
                                        <p>
                                            <input class="btn btn-default" value="Subscribe Now" type="submit">
                                        </p>
                                    </div>
                                </div>
                            </div>

                        </div> <!--  end .col-md-4 col-sm-12 -->  

                    </div> <!-- end row  -->

                </div> <!-- end .container  -->

            </section> <!--  end .footer-widget-area  -->

            <!--FOOTER CONTENT  -->

            <section class="footer-contents">

                <div class="container">

                    <div class="row clearfix">
                        
                        <div class="col-md-12 col-sm-12 text-center">
                            <p class="copyright-text"> Powered by ektha.com, Copyright 2024 - ekthacares. All Rights Reserved. </p>
                        </div>  <!-- end .col-sm-6  -->

                    </div> <!-- end .row  -->                                    

                </div> <!--  end .container  -->

            </section> <!--  end .footer-content  -->

        </footer>

      

        <a id="backTop">Back To Top</a>

        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/wow.min.js"></script>
        <script src="js/jquery.backTop.min.js "></script>
        <script src="js/waypoints.min.js"></script>
        <script src="js/waypoints-sticky.min.js"></script>
        <script src="js/owl.carousel.min.js"></script>
        <script src="js/jquery.stellar.min.js"></script>
        <script src="js/jquery.counterup.min.js"></script>
        <script src="js/venobox.min.js"></script>
        <script src="js/custom-scripts.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    $(document).ready(function() {
        $('.view-profile1').hover(function(e) {
            var userId = $(this).data('user-id');
            var tooltip = $('#profileTooltip');
            
            // Show tooltip close to cursor position
            tooltip.css({
                top: e.pageY + 10 + 'px',  // Slight offset for visibility
                left: e.pageX + 10 + 'px'
            }).show();

            // AJAX request to load the user profile
            $.ajax({
                url: '/user/' + userId,
                method: 'GET',
                success: function(data) {
                    tooltip.html(data);
                },
                error: function() {
                    tooltip.html('<p>Error loading profile</p>');
                }
            });
        }, function() {
            $('#profileTooltip').hide().html('');
        });

        // Update tooltip position as the mouse moves
        $('.view-profile1').mousemove(function(e) {
            $('#profileTooltip').css({
                top: e.pageY + 10 + 'px',   // Minimal offset to keep it near the cursor
                left: e.pageX + 10 + 'px'
            });
        });
    });
</script>
<script>
    function filterRequests() {
        const filter = document.getElementById("filterSelect").value;
        const rows = document.querySelectorAll("tbody tr");
        let visibleRowCount = 0; // Variable to count visible rows

        const resultCountElement = document.getElementById("resultCount");
        const totalResultsCountElement = document.getElementById("totalResultsCount");

        rows.forEach(row => {
            const timestampStr = row.cells[5].innerText.trim(); // Get the formatted timestamp string
            const timestamp = parseFormattedTimestamp(timestampStr); // Parse the timestamp to a Date object
            const now = new Date();

            let showRow = true;

            // Apply filter logic based on selection
            if (filter === "week") {
                const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(endOfWeek.getDate() + 6);
                showRow = timestamp >= startOfWeek && timestamp <= endOfWeek;
            } else if (filter === "month") {
                const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                showRow = timestamp >= startOfMonth && timestamp <= endOfMonth;
            } else if (filter === "last3months") {
                const startOf3MonthsAgo = new Date(now.getFullYear(), now.getMonth() - 3, 1);
                showRow = timestamp >= startOf3MonthsAgo;
            } else {
                // If no filter is selected, show all rows
                showRow = true;
            }

            // Show or hide row based on filter condition
            if (showRow) {
                row.style.display = ""; // Show row
                visibleRowCount++; // Increment visible row count
            } else {
                row.style.display = "none"; // Hide row
            }
        });

        // Show the result count if a filter is applied
        if (filter !== "") {
            resultCountElement.style.display = "block"; // Show result count when filter is applied
            resultCountElement.innerText = visibleRowCount + " results found";

            // Hide total results count when a filter is applied
            totalResultsCountElement.parentElement.style.display = "none"; 
        } else {
            // Show total results count when no filter is selected
            resultCountElement.style.display = "none"; // Hide result count
            totalResultsCountElement.parentElement.style.display = "block"; // Show total results
        }
    }

    // Function to parse 'dd/MM/yyyy HH:mm:ss' into a JavaScript Date object
    function parseFormattedTimestamp(timestampStr) {
        const [datePart, timePart] = timestampStr.split(" ");
        const [day, month, year] = datePart.split("/").map(Number);
        const [hours, minutes, seconds] = timePart.split(":").map(Number);
        return new Date(year, month - 1, day, hours, minutes, seconds);
    }
</script>


 </body>

</html>
